<tool id="muon_import_pbmc10k" name="Import and read 10k PBMC data with muon" version="0.1.0">
    <requirements>
        <requirement type="package" version="1.7.0">scanpy</requirement>
        <requirement type="package" version="0.1.2">muon</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        python '$script_file'
]]></command>
    <configfiles>
        <configfile name="script_file"><![CDATA[import scanpy as sc
import muon as mu
mdata = mu.read_10x_h5(os.path.join(data_dir, "$filtered_feature_bc_matrix.h5"))
mdata.var_names_make_unique()
mdata
mdata.write("10k_pbmc_mudata.h5mu")
]]></configfile>
    </configfiles>
    <inputs>
        <param name="filtered_feature_matrix" type="data" format="h5" label="Filtered Feature Barcode Matrix" help="(.h5)"/>
        <param name="atac_per_fragment" type="data" format="tsv, tabular" label="ATAC per fragment" help="(.tsv.gz)"/>
        <param name="atac_per_fragment_info_index" type="data" format="tsv, tabular" label="ATAC per fragment information index" help="(.tsv.gz.tbi)"/>
        <param name="atac_peak_annotations" type="data" format="tsv" label="ATAC peak annotations" help="(.tsv)"/>
    </inputs>
    <outputs>
        <data name="10k_pbmc_mudata" format="h5mu" label="10k PBMC Mudata" from_work_dir="10k_pbmc_mudata.h5mu"/>
    </outputs>
    <tests>
        <test>
            <param name="filtered_feature_matrix" value="filtered_feature_matrix.h5"/>
            <param name="atac_per_fragment" value="atac_per_fragment.tsv.gz"/>
            <param name="atac_per_fragment_info_index" value="atac_per_fragment_info_index.tsv.gz.tbi"/>
            <param name="atac_peak_annotations" value="atac_peak_annotations.tsv)"/>
            <output name="10k_pbmc_mudata" file="10k_pbmc_mudata.h5mu"/>
        </test>
    </tests>
    <help><![CDATA[

        This tool imports and reads 10k PBMC data with multiple modalities using muon as a MuData object (.h5mu).


    ]]></help>
    <citations>
    </citations>
</tool>